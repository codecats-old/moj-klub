(function(){strz_Ajax.Component=function(a){if(a){this.set(a)}};strz_Ajax.Component.prototype={triggerName:null,setTriggerName:function(a){this.triggerName=a},getTriggerName:function(){return this.triggerName},componentName:null,setComponentName:function(a){this.componentName=a},getComponentName:function(){return this.componentName},params:null,setParams:function(a){this.params=a},getParams:function(){return this.params},init:function(){var b=this.getTriggerName();var a=this.getComponentName();var c=this.getParams();$(b)[a](c)},set:function(a){this.setTriggerName(a.trigger);this.setComponentName(a.component);this.setParams(a.params);if(a.init===true){this.init()}}}})();(function(){strz_Ajax.Data={resources:null,resourcesSession:null,prefix:"strz_Ajax.Data.",save:function(a,b){return this._insert(this.resources,a,b)},load:function(a){return this._select(this.resources,a)},clear:function(a){return this._delete(this.resources,a)},set:function(a,b){return this._insert(this.resourcesSession,a,b)},get:function(a){return this._select(this.resourcesSession,a)},remove:function(a){return this._delete(this.resourcesSession,a)},_insert:function(c,a,b){c.setItem(this._getField(a),b);return this},_select:function(c,a){var b=c.getItem(this._getField(a));return this._filter(b)},_delete:function(b,a){b.removeItem(this._getField(a));return this},_destroy:function(a){a.clear();return this},_getField:function(a){return(this.prefix+a)},_filter:function(a){return JSON.parse(a)}};if(typeof(Storage)!=="undefined"){strz_Ajax.Data.resources=localStorage;strz_Ajax.Data.resourcesSession=sessionStorage}else{console.log("Browser not support HTML5 Storage. What's a pity...")}})();(function(){strz_Ajax.Http={baseDir:null,getHost:function(){return window.document.location.host},getSecoundLevel:function(){var a=(this.baseDir!==null)?this.baseDir:this.readBaseDirCookie();return a},getUrl:function(){var d=window.document.location.protocol;var b=this.getHost();var c=this.getSecoundLevel();var a=d+"//"+b+c;if(a.substr(a.length-1)==="/"){a=a.substr(0,a.length-1)}return a},getIndexName:function(a){a=(typeof(a)==="undefined"||a===false)?"":"/";return("index.php"+a)},getFullUrl:function(b){var a=this.getUrl()+"/"+this.getIndexName(b);return a},readBaseDirCookie:function(){var a=$.cookie("basedir");a=a.split("~")[1];this.baseDir=a;return(typeof(a!=="undefined")?a:"")}}})();(function(){strz_Ajax.Notificator=function(b){var a=this;var c=function(d){a._set("intervalTime",a.minimumIntervalValue);a.init()};c(b)};strz_Ajax.Notificator.prototype={durationTime:null,interval:null,lastCheckedTime:0,isActive:null,lastNotificationTimeFrom:0,lastNotificationTimeTo:0,requestor:null,attrs:{},panel:null,minimumIntervalValue:10000,init:function(){var c=this.checker();this.initRequestor();this.getConfig();var b=this._get("intervalTime");this.interval=window.setInterval(function(){c()},b);var a=this.changeIcon;this.panel=new strz_Ajax.Panel(function(){a(false)});this.panel.init()},checker:function(){var a=this;return function(){var b=new Date();if(typeof(a.lastNotificationTimeFrom)==="undefined"){a.isActive=strz_Ajax.Data.get("isActive");a.lastNotificationTimeFrom=strz_Ajax.Data.get("lastNotificationTimeFrom");a.lastNotificationTimeTo=strz_Ajax.Data.get("lastNotificationTimeTo")}if(typeof(a.lastNotificationTimeFrom)==="undefined"||a.lastNotificationTimeTo<b.getTime()){a.lastCheckedTime=b.getTime();a.requestor.ajaxInitialize()}}},ajaxDone:function(b,a){b=JSON.parse(b);return b},changeIcon:function(a){if(a===true){$("a[rel=notification-icon]").addClass("blinking-icon")}else{$("a[rel=notification-icon]").removeClass("blinking-icon")}},initRequestor:function(){this.requestor=new strz_Ajax.NodeAction();var a=this.getDestination("notification");this.requestor.setSendToURL(a);var b=this;var c=this.ajaxDone;this.requestor.ajaxDone=function(e,d){e=c(e,d);if(typeof(e.duration)!=="undefined"){b.durationTime=e.duration;strz_Ajax.Data.set("durationTime",e.duration)}if(typeof(e.active)!=="undefined"){e.from=(e.from===null)?0:e.from;e.to=(e.to===null)?0:e.to;e.from*=1000;e.to*=1000;b.isActive=e.active;b.lastNotificationTimeFrom=e.from;b.lastNotificationTimeTo=e.to;strz_Ajax.Data.set("isActive",e.active);strz_Ajax.Data.set("lastNotificationTimeFrom",e.from);strz_Ajax.Data.set("lastNotificationTimeTo",e.to);b.changeIcon(b.isActive)}}},getConfig:function(){if(strz_Ajax.Data.get("durationTime")===undefined||strz_Ajax.Data.get("durationTime")===null){strz_Ajax.Data.set("durationTime",(this.minimumIntervalValue/1000));var a=this.requestor.getSendToURL();this.requestor.setSendToURL(this.getDestination("notification-config"));this.requestor.ajaxInitialize();this.requestor.setSendToURL(a)}else{this.durationTime=strz_Ajax.Data.get("durationTime");strz_Ajax.Data.set("durationTime",this.durationTime);if(this.durationTime!==null){this._set("intervalTime",(this.durationTime*1000))}else{this._set("intervalTime",(this.minimumIntervalValue))}}},getDestination:function(a){return strz_Ajax.Http.getFullUrl(true)+"ajax/"+a},_get:function(a){return this.attrs[a]},_set:function(a,b){this.attrs[a]=b},_initAttrs:function(b){for(var a in b){this._set(a,b[a])}}}})();(function(){strz_Ajax.Panel=function(b){var a=this;var c=function(d){a.statusListener=d};c(b)};strz_Ajax.Panel.prototype={statusListener:null,requestor:null,mouseOverTimeout:null,continueRead:null,switcherMenu:null,initOpenListener:function(a,b){self=this;$(a).on("click",function(){self.statusListener();$(a).children().removeClass("icon-envelope");$(a).children().addClass("icon-refresh");$(b).fadeIn("fast")})},initCloseListener:function(b,c){var a=this.mouseOverTimeout;var d=function(e){$(c+" .close").removeClass("ajax-load");$(c).fadeOut(e);$(b).children().removeClass("icon-refresh");$(b).children().addClass("icon-envelope")};$(c).on("mouseleave",function(e){a=window.setTimeout(function(){d("fast")},2500);$(c+" .close").addClass("ajax-load")});$(c).on("mouseenter",function(e){if(a){clearTimeout(a)}$(c+" .close").removeClass("ajax-load")});$(c+" .close").on("click",function(e){d("slow")})},init:function(){var a="a[rel=notification-icon]";this.requestor=new strz_Ajax.NotificatorPanelAjaxGet(a);this.requestor.run();var b="ul[rel=notification-menu]";this.initOpenListener(a,b);this.initCloseListener(a,b);this.switcherMenu=new strz_Ajax.NotificatorPanelAjaxMenuSwitch(a,this.requestor);this.switcherMenu.run();this.requestor.addCallback({switcherMenu:{reference:this.switcherMenu,methods:{run:null}}})}}})();(function(){strz_Ajax.NotificatorPanelAjaxGet=function(a){this.init();this.getterTrigger=a};strz_Ajax.NotificatorPanelAjaxGet.prototype={run:function(){this.setTriggerSelector(this.getterTrigger);if($(this.getTriggerSelector()).length>0){this.setCallbackMyself(false);this.setEventName("click");this.setSendInformator(this.getTriggerSelector());this.setSendToURL($(this.getTriggerSelector())[0].href);this.setContentShow("ul[rel=notification-messages]");this.ajaxRun()}},ajaxDone:function(d,c){d=JSON.parse(d);var b=c.getContentShow();if(d.View.length>0||($(b+"> li[sender=-1]").length===0)){$(b+"> li[sender]").remove()}for(var a in d.View){$(b).append(d.View[a]["view"])}if(d.status){$().toastmessage("show"+d.status.state+"Toast",d.status.message)}}};strz_Ajax.Extend(strz_Ajax.NotificatorPanelAjaxGet,strz_Ajax.NodeAction)})();(function(){strz_Ajax.NotificatorPanelAjaxContinue=function(c,b,a){this.init();this.getterTrigger=c;this.triggerHref=b;this.triggerContent=a};strz_Ajax.NotificatorPanelAjaxContinue.prototype={triggerHref:null,triggerContent:null,lastSender:null,iterator:1,run:function(){this.setTriggerSelector(this.getterTrigger);if($(this.getTriggerSelector()).length>0){this.setCallbackMyself(false);this.setEventName("click");this.setSendInformator(this.getTriggerSelector());this.setContentShow(this.triggerContent);this.ajaxRun();this.refresh()}},refresh:function(){var b=this.getContentShow();this.iterator=1;this.lastSender=this.checkLastSender(b+">li[sender]");var a=this.buildUrl(this.triggerHref,this.iterator);this.setSendToURL(a);$(this.getTriggerSelector()).removeAttr("disabled")},ajaxDone:function(f,e){f=JSON.parse(f);e.iterator++;var d=e.getContentShow();var b=e.buildUrl(e.triggerHref,e.iterator);e.setSendToURL(b);for(var c in f.View){var g=$(d+"> li[sender="+f.View[c]["key"]+"]");if(g.length>0){g[0].outerHTML=f.View[c]["view"]}else{$(d).append(f.View[c]["view"])}}if(f.status){$().toastmessage("show"+f.status.state+"Toast",f.status.message)}var a=e.checkLastSender(d+"> li[sender]");if(isNaN(a)||a===e.lastSender){$(e.getTriggerSelector()).attr("disabled","disabled")}else{e.lastSender=a}},checkLastSender:function(a){return parseInt($(a).last().attr("sender"))},buildUrl:function(a,b){return $(a)[0].href+"/"+b}};strz_Ajax.Extend(strz_Ajax.NotificatorPanelAjaxContinue,strz_Ajax.NodeAction)})();(function(){strz_Ajax.NotificatorPanelAjaxMenuSwitch=function(a,b){this.triggerIcon=a;this.requestor=b};strz_Ajax.NotificatorPanelAjaxMenuSwitch.prototype={triggerIcon:null,requestor:null,submenus:{team:null,user:null},run:function(){this.submenus.team=new strz_Ajax.NotificatorPanelAjaxMenuTeam(this.onSwitchContext());this.submenus.user=new strz_Ajax.NotificatorPanelAjaxMenuUser(this.onSwitchContext());this.submenus.team.run();this.submenus.user.run();this.initContinueReadButton()},onSwitchContext:function(){var a=this;return function(c){triggerActivated=c.getTriggerSelector();triggerIcon=a.triggerIcon;$(a.triggerIcon).attr("href",$(triggerActivated).attr("href"));a.changeIconAddress($(triggerActivated).attr("href"));a.initContinueReadButton();submenuNames=a.getSubmenusNames();trigCont=c.getTriggerSelector();if($(trigCont).hasClass("disabled")===true){window.location.href=$(trigCont)[0].href}else{var e=a.getSubmenusNames();for(var b in e){var d=a.setRelLastArgument(trigCont,e[b]);if(d===trigCont){$(trigCont).addClass("disabled")}else{$(d).removeClass("disabled")}}}}},initContinueReadButton:function(){this.continueRead=new strz_Ajax.NotificatorPanelAjaxContinue("button[rel=notification-featch-more]",this.triggerIcon,"ul[rel=notification-messages]");this.continueRead.run();this.continueRead.addCallback({teamListener:{reference:this.submenus.team,methods:{initializeButtons:null}},userListener:{reference:this.submenus.user,methods:{initializeButtons:null}}})},getSubmenusNames:function(){var a=[];for(var b in this.submenus){a.push(b)}return a},setRelLastArgument:function(b,c){var a=b.split("-");a[a.length-1]=(c+"]");return a.join("-")},changeIconAddress:function(a){this.requestor.setSendToURL(a)}}})();(function(){strz_Ajax.NotificatorPanelAjaxMenuTeam=function(a){this.init();this.listener=a};strz_Ajax.NotificatorPanelAjaxMenuTeam.prototype={listener:null,contentTrig:null,isRunning:false,run:function(){this.setTriggerSelector("a[rel=notification-switch-team]");if($(this.getTriggerSelector()).length>0){this.isRunning=true;this.contentTrig="ul[rel=notification-messages]";this.setCallbackMyself(false);this.setEventName("click");this.setSendInformator(this.getTriggerSelector());this.setSendToURL($(this.getTriggerSelector())[0].href);this.setContentShow(this.contentTrig);this.ajaxRun();this.initializeButtons();this.addCallback({switchListener:{reference:this,methods:{listener:this,initializeButtons:null}}})}},initializeButtons:function(){if(this.isRunning){var a=this.contentTrig;var d=this.setButton;var e=$(a+" li[sender]").map(function(){return $(this).attr("sender")}).get();for(var c in e){var b=a+" li[sender="+e[c]+"] .btn-group";d(b+" a[rel=accept]");d(b+" a[rel=refuse]");d(b+" a[rel=cancel]")}}},setButton:function(a){var b=new strz_Ajax.NotificatorPanelAjaxMenuButton(a);b.ajaxDone=function(d,c){d=JSON.parse(d);var e=$(c.getContentShow()+">li[sender="+d.View[0]["key"]+"]");if(e.length>0){e[0].outerHTML=d.View[0]["view"]}};b.run()}};strz_Ajax.Extend(strz_Ajax.NotificatorPanelAjaxMenuTeam,strz_Ajax.NotificatorPanelAjaxGet)})();(function(){strz_Ajax.NotificatorPanelAjaxMenuUser=function(a){this.init();this.listener=a};strz_Ajax.NotificatorPanelAjaxMenuUser.prototype={listener:null,contentTrig:null,isRunning:false,run:function(){this.setTriggerSelector("a[rel=notification-switch-user]");if($(this.getTriggerSelector()).length>0){this.isRunning=true;this.contentTrig="ul[rel=notification-messages]";this.setCallbackMyself(false);this.setEventName("click");this.setSendInformator(this.getTriggerSelector());this.setSendToURL($(this.getTriggerSelector())[0].href);this.setContentShow(this.contentTrig);this.ajaxRun();this.initializeButtons();this.addCallback({switchListener:{reference:this,methods:{listener:this,initializeButtons:null}}})}},initializeButtons:function(){if(this.isRunning){var a=this.contentTrig;var d=this.setButton;var e=$(a+" li[sender]").map(function(){return $(this).attr("sender")}).get();for(var c in e){var b=a+" li[sender="+e[c]+"] .btn-group";d(b+" a[rel=cancel-owner]")}}},setButton:function(a){var b=new strz_Ajax.NotificatorPanelAjaxMenuButton(a);b.ajaxDone=function(d,c){d=JSON.parse(d);var e=$(c.getContentShow()+">li[sender="+d.View[0]["key"]+"]");if(e.length>0){e.html(d.View[0]["view"]);if(d.status){$().toastmessage("show"+d.status.state+"Toast",d.status.message)}window.setTimeout(function(){e.fadeOut("slow");window.location.reload()},1200)}};b.run()}};strz_Ajax.Extend(strz_Ajax.NotificatorPanelAjaxMenuUser,strz_Ajax.NotificatorPanelAjaxGet)})();(function(){strz_Ajax.NotificatorPanelAjaxMenuButton=function(a){this.init();this.triggerSelector=a};strz_Ajax.NotificatorPanelAjaxMenuButton.prototype={triggerSelector:null,run:function(){this.setTriggerSelector(this.triggerSelector);if($(this.getTriggerSelector()).length>0){this.setCallbackMyself(false);this.setEventName("click");this.setSendInformator(this.getTriggerSelector());this.setSendToURL($(this.getTriggerSelector())[0].href);this.setContentShow("ul[rel=notification-messages]");this.ajaxRun()}}};strz_Ajax.Extend(strz_Ajax.NotificatorPanelAjaxMenuButton,strz_Ajax.NotificatorPanelAjaxGet)})();(function(){strz_Ajax.QuickAccess=function(a){};strz_Ajax.QuickAccess.prototype={trigger:"button[data-target=#quick_access]",content:"div#quick_access",stateName:"QuickAccess.state",init:function(){var a=this.content;var b=this.stateName;$(this.trigger).click(function(){var c=(!$(a).hasClass("in"))?true:false;strz_Ajax.Data.save(b,c)});if(strz_Ajax.Data.load(b)===false){$(a).removeClass("in")}}}})();(function(){strz_Ajax.Runner=function(a){};strz_Ajax.Runner.prototype={trigger:"#timer",startButton:"#timerStart",resetButton:"#timerReset",stopButton:"#timerStop",fullScrBtn:"button[rel=runner-fullscreen]",init:function(){var b=this.trigger,a=this.startButton;$(this.trigger).runner({autostart:false,milliseconds:false});$(this.startButton).click(function(c){c.preventDefault();$(b).runner("start");$(a).addClass("active")});$(this.resetButton).click(function(c){c.preventDefault();$(b).runner("reset")});$("#timerStop").click(function(c){c.preventDefault();$(b).runner("stop");$(a).removeClass("active")});$(this.fullScrBtn).click(this.listeners.toggleFullScreen)},listeners:{toggleFullScreen:function(b){b.preventDefault();var a=$("div.runner")[0];if(a.requestFullscreen){a.requestFullscreen()}else{if(a.mozRequestFullScreen){a.mozRequestFullScreen()}else{if(a.webkitRequestFullscreen){a.webkitRequestFullscreen()}}}}}}})();